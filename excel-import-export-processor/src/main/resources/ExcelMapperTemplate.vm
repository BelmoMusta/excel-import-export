package $wrapper.aPackage;

import $wrapper.className;
import io.github.belmomusta.excel.api.export.AbstractExcelMapper;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;

public class ${wrapper.simplifiedClassName}ExcelMapper extends AbstractExcelMapper<$wrapper.simplifiedClassName> {

#if($wrapper.withHeaders)
    @Override
    protected void writeHeaders(Sheet sheet) {
        final Row header = sheet.createRow(0);
#foreach($header in $wrapper.correspondanceFieldMethod)
#if($header.ordered)
        addCellWithValue(header, $header.order, "${header.name}");
#else
        addCellWithValue(header, "${header.name}");
#end
#end
    }
#end

    @Override
    protected void createRows(Sheet sheet, $wrapper.simplifiedClassName data) {
        final Row row = sheet.createRow(sheet.getLastRowNum() + 1);
#foreach($pair in $wrapper.correspondanceFieldMethod)
#if($pair.ordered)
        addCellWithValue(row, $pair.order, valueOf(data.${pair.method}()));
#else
        addCellWithValue(row, valueOf(data.${pair.method}()));
#end
#end
    }

    @Override
    public String getClassName(){
        return ${wrapper.simplifiedClassName}.class.getName();
    }
}
